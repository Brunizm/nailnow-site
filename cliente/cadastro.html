<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Crie sua conta NailNow para agendar profissionais verificadas com rapidez, suporte e benefícios exclusivos."
    />
    <title>Cadastro de Cliente | NailNow</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../styles.css" />

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
      import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
      import { getFirestore, doc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyBHVZ9M6btJemXCIG-g5dG0xWq_jy50H7o",
        authDomain: "nailnow-site.firebaseapp.com",
        projectId: "nailnow-site",
        storageBucket: "nailnow-site.appspot.com",
        messagingSenderId: "726392294571",
        appId: "1:726392294571:web:a363a40231f7ac162e7bee",
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const db = getFirestore(app);

      async function cadastrarCliente(event) {
        event.preventDefault();
        const form = event.target;
        const btn = form.querySelector("button[type='submit']");
        const feedback = document.getElementById("signup-feedback");
        feedback.textContent = "";

        try {
          const nome = form.nome.value.trim();
          const email = form.email.value.trim().toLowerCase();
          const senha = form.senha.value;
          const confirmarSenha = form.confirmarSenha.value;
          const telefone = form.telefone.value.trim();
          const nascimento = form.nascimento.value;
          const endereco = form.endereco_text.value.trim();
          const complemento = form.complemento.value.trim();
          const preferencias = Array.from(form.querySelectorAll('input[name="preferencias"]:checked')).map((el) => el.value);
          const newsletter = form.newsletter.checked;
          const aceiteTermos = form.aceiteTermos.checked;

          const endereco_formatado = form.endereco_formatado.value || "";
          const place_id = form.place_id.value || "";
          const lat = form.lat.value || "";
          const lng = form.lng.value || "";

          if (!nome || !email || !senha || !confirmarSenha || !endereco) {
            feedback.textContent = "Preencha os campos obrigatórios (*).";
            feedback.style.color = "#c62828";
            return;
          }

          if (senha !== confirmarSenha) {
            feedback.textContent = "As senhas não coincidem.";
            feedback.style.color = "#c62828";
            form.confirmarSenha.focus();
            return;
          }

          if (!aceiteTermos) {
            feedback.textContent = "É necessário aceitar os termos para continuar.";
            feedback.style.color = "#c62828";
            return;
          }

          btn.disabled = true;
          btn.textContent = "Criando conta…";

          const cred = await createUserWithEmailAndPassword(auth, email, senha);
          const uid = cred.user.uid;

          await setDoc(doc(db, "clientes", uid), {
            uid,
            nome,
            email,
            telefone,
            nascimento,
            endereco,
            complemento,
            endereco_formatado,
            place_id,
            lat,
            lng,
            preferencias,
            newsletter,
            aceiteTermos,
            criadoEm: serverTimestamp(),
          });

          feedback.textContent = "✅ Conta criada com sucesso!";
          feedback.style.color = "#2e7d32";
          form.reset();
          form.querySelector("[name='aceiteTermos']").checked = false;
          form.querySelector("[name='newsletter']").checked = true;
        } catch (error) {
          console.error(error);
          feedback.textContent = `❌ Erro: ${error.code || "erro-desconhecido"}`;
          feedback.style.color = "#c62828";
        } finally {
          btn.disabled = false;
          btn.textContent = "Criar conta cliente";
        }
      }

      window.cadastrarCliente = cadastrarCliente;
    </script>
  </head>

  <body>
    <div class="promo-banner">Clientes NailNow: agende profissionais verificadas com conforto e segurança.</div>

    <header class="site-header">
      <div class="header-inner">
        <a href="../index.html" class="brand-mark" aria-label="Início da NailNow">NailNow</a>
        <div class="header-navigation">
          <nav class="primary-nav" aria-label="Principal">
            <a href="../index.html" class="nav-link">Home</a>
            <a href="../como-funciona.html" class="nav-link">Como funciona</a>
            <a href="../servicos.html" class="nav-link">Serviços</a>
            <a href="../agendamentos.html" class="nav-link">Agendamentos</a>
          </nav>
          <div class="header-actions">
            <a href="../cliente/index.html" class="header-cta" aria-current="page">Sou Cliente</a>
            <a href="../profissional/index.html" class="header-cta">Sou Profissional</a>
            <a
              class="social-link social-link--instagram"
              href="https://www.instagram.com/nailnowbr/"
              target="_blank"
              rel="noopener noreferrer"
              aria-label="Instagram da NailNow"
            >
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M7 3C4.24 3 2 5.24 2 8v8c0 2.76 2.24 5 5 5h10c2.76 0 5-2.24 5-5V8c0-2.76-2.24-5-5-5H7zm10 2a3 3 0 0 1 3 3v8a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V8a3 3 0 0 1 3-3h10zm-5 3.5A4.5 4.5 0 1 0 16.5 13 4.5 4.5 0 0 0 12 8.5zm0 2A2.5 2.5 0 1 1 9.5 13 2.5 2.5 0 0 1 12 10.5zm4.75-4.75a1 1 0 1 0 1 1 1 1 0 0 0-1-1z"
                />
              </svg>
            </a>
          </div>
        </div>
      </div>
    </header>

    <main>
      <section class="hero hero--client" aria-labelledby="cadastro-cliente">
        <div class="hero-copy">
          <span class="hero-label">Para clientes</span>
          <h1 id="cadastro-cliente">Crie sua conta e agende em minutos</h1>
          <p>
            Cadastre-se para encontrar profissionais avaliadas perto de você, acompanhar cada etapa do atendimento e receber suporte
            humanizado sempre que precisar.
          </p>
          <ul class="client-perks">
            <li>Profissionais verificadas com avaliações reais de outras clientes.</li>
            <li>Agendamentos rápidos com lembretes automáticos e pagamento seguro.</li>
            <li>Atendimento em casa ou no trabalho com cobertura NailNow.</li>
          </ul>
        </div>

        <div class="hero-media hero-media--signup">
          <div class="client-signup-card">
            <h2 class="client-signup-card__title">Comece agora</h2>
            <p class="client-signup-card__subtitle">Preencha seus dados para desbloquear ofertas e agendar sem filas.</p>
            <form class="signup-form" onsubmit="cadastrarCliente(event)" autocomplete="off">
              <div class="signup-field">
                <label for="nome">Nome completo *</label>
                <input id="nome" name="nome" type="text" required />
              </div>

              <div class="signup-field">
                <label for="email">E-mail *</label>
                <input id="email" name="email" type="email" required />
              </div>

              <div class="signup-field">
                <label for="telefone">Telefone / WhatsApp</label>
                <input id="telefone" name="telefone" type="tel" placeholder="(11) 99999-0000" />
              </div>

              <div class="signup-row">
                <div class="signup-field">
                  <label for="senha">Senha *</label>
                  <input id="senha" name="senha" type="password" minlength="6" required />
                </div>
                <div class="signup-field">
                  <label for="confirmarSenha">Confirmar senha *</label>
                  <input id="confirmarSenha" name="confirmarSenha" type="password" minlength="6" required />
                </div>
              </div>

              <div class="signup-field">
                <label for="nascimento">Data de nascimento</label>
                <input id="nascimento" name="nascimento" type="date" />
              </div>

              <input type="text" name="ignore_autofill" autocomplete="off" class="autofill-trap" aria-hidden="true" />

              <div class="signup-field">
                <label for="endereco">Endereço de atendimento *</label>
                <input
                  id="endereco"
                  name="endereco_text"
                  type="text"
                  required
                  autocomplete="off"
                  autocapitalize="off"
                  autocorrect="off"
                  spellcheck="false"
                  inputmode="text"
                />
              </div>

              <input type="hidden" id="endereco_formatado" name="endereco_formatado" />
              <input type="hidden" id="place_id" name="place_id" />
              <input type="hidden" id="lat" name="lat" />
              <input type="hidden" id="lng" name="lng" />

              <div class="signup-field">
                <label for="complemento">Complemento / Referência</label>
                <input id="complemento" name="complemento" type="text" placeholder="Apartamento, bloco, portaria..." />
              </div>

              <div class="signup-field">
                <span class="signup-field__legend">Preferências de atendimento</span>
                <div class="services-grid services-grid--compact">
                  <label><input type="checkbox" name="preferencias" value="Manicure clássica" /> Manicure clássica</label>
                  <label><input type="checkbox" name="preferencias" value="Pedicure clássica" /> Pedicure clássica</label>
                  <label><input type="checkbox" name="preferencias" value="Esmaltação em gel" /> Esmaltação em gel</label>
                  <label><input type="checkbox" name="preferencias" value="Spa dos pés" /> Spa dos pés</label>
                  <label><input type="checkbox" name="preferencias" value="Alongamento" /> Alongamento</label>
                </div>
              </div>

              <label class="signup-checkbox">
                <input type="checkbox" name="newsletter" checked />
                Quero receber novidades, combos e cupons exclusivos por e-mail ou WhatsApp.
              </label>

              <label class="signup-checkbox signup-checkbox--terms">
                <input type="checkbox" name="aceiteTermos" required />
                <span class="signup-checkbox__text">
                  Li e aceito os <a href="#">Termos de uso</a> e a <a href="#">Política de privacidade</a> da NailNow.
                </span>
              </label>

              <button type="submit" class="signup-submit">Criar conta cliente</button>
              <p id="signup-feedback" class="signup-feedback" role="status" aria-live="polite"></p>
            </form>
          </div>
        </div>
      </section>

      <section class="client-highlight" aria-label="Por que agendar com a NailNow">
        <div class="client-highlight__intro">
          <span class="eyebrow">Benefícios para você</span>
          <h2>Experiência premium do agendamento ao pós-atendimento</h2>
          <p>
            Aproveite um ecossistema completo com profissionais selecionadas, suporte em tempo real e vantagens exclusivas em cada
            atendimento.
          </p>
        </div>
        <div class="client-highlight__grid">
          <article class="client-highlight__card">
            <h3>Profissionais verificadas</h3>
            <p>Documentos checados, teste prático e avaliações constantes garantem atendimentos seguros.</p>
          </article>
          <article class="client-highlight__card">
            <h3>Pagamento protegido</h3>
            <p>Transações seguras com confirmação instantânea e nota fiscal enviada ao seu e-mail.</p>
          </article>
          <article class="client-highlight__card">
            <h3>Suporte humanizado</h3>
            <p>Equipe pronta para ajudar antes, durante e após o agendamento em múltiplos canais.</p>
          </article>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      <div class="footer-inner">
        <div class="footer-column footer-column--brand">
          <h2 class="footer-logo">NailNow</h2>
          <p>Beleza na sua agenda com profissionais selecionadas, atendimento onde você estiver e suporte humanizado.</p>
        </div>
        <div class="footer-column footer-links" aria-label="Links úteis">
          <h3>FAQ</h3>
          <a href="../faq.html">Perguntas frequentes</a>
          <a href="../como-funciona.html">Como funciona</a>
          <a href="../agendamentos.html">Agendamentos</a>
        </div>
        <div class="footer-column footer-links" aria-label="Contato e suporte">
          <h3>Contato & suporte</h3>
          <a href="mailto:contato@nailnow.com">contato@nailnow.com</a>
        </div>
        <div class="footer-column footer-links" aria-label="Termos e políticas">
          <h3>Termos & políticas</h3>
          <a href="#">Termos de uso</a>
          <a href="#">Política de privacidade</a>
          <a href="#">Cookies e preferências</a>
        </div>
      </div>
      <p class="footer-copy">© NailNow 2025. Todos os direitos reservados.</p>
    </footer>

    <nav class="bottom-nav" aria-label="Navegação inferior fixa">
      <a href="../index.html" class="bottom-nav__link" aria-label="Ir para o início">Home</a>
      <a href="../servicos.html" class="bottom-nav__link" aria-label="Buscar serviços profissionais">Buscar</a>
      <a href="../cliente/index.html" class="bottom-nav__link" aria-label="Ver agendamentos">Agendamentos</a>
      <a href="../cliente/" class="bottom-nav__link" aria-label="Ver perfil ou fazer login">Perfil</a>
    </nav>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCeFS75JZeUXATAztu5ntNpgCT-wfNlai0&libraries=places&language=pt-BR&region=BR" defer></script>
    <script>
      window.initEnderecoAutocomplete = function () {
        const input = document.getElementById("endereco");
        if (!input || !window.google || !google.maps?.places) return;

        const ac = new google.maps.places.Autocomplete(input, {
          types: ["geocode"],
          componentRestrictions: { country: "br" },
          fields: ["formatted_address", "place_id", "geometry"],
        });

        ac.addListener("place_changed", () => {
          const place = ac.getPlace();
          const loc = place.geometry?.location;
          document.getElementById("endereco_formatado").value = place.formatted_address || "";
          document.getElementById("place_id").value = place.place_id || "";
          document.getElementById("lat").value = loc?.lat() || "";
          document.getElementById("lng").value = loc?.lng() || "";
          console.log("📍 Endereço salvo:", place.formatted_address);
        });
      };

      window.addEventListener("load", () => {
        const tryInit = () => {
          if (window.google && google.maps?.places) window.initEnderecoAutocomplete();
          else setTimeout(tryInit, 300);
        };
        tryInit();
      });
    </script>
  </body>
</html>
