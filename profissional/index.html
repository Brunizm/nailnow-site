<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Profissionais | NailNow</title>
    <meta
      name="description"
      content="Seja uma profissional NailNow: receba convites inteligentes, tenha pagamentos garantidos e suporte completo para crescer na carreira."
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../styles.css" />
  </head>
  <body>
    <div class="promo-banner">Profissionais NailNow: autonomia, visibilidade e pagamentos garantidos.</div>

    <header class="site-header">
      <div class="header-inner">
        <a href="/" class="brand-mark" aria-label="Início da NailNow">NailNow</a>
        <div class="header-navigation">
          <nav class="primary-nav" aria-label="Principal">
            <a href="/" class="nav-link">Home</a>
            <a href="../como-funciona.html" class="nav-link">Como funciona</a>
            <a href="../servicos.html" class="nav-link">Serviços</a>
            <a href="../agendamentos.html" class="nav-link">Agendamentos</a>
          </nav>
          <div class="header-actions">
            <a href="../cliente/index.html" class="header-cta">Sou Cliente</a>
            <a href="../profissional/index.html" class="header-cta">Sou Profissional</a>
            <a
              class="social-link social-link--instagram"
              href="https://www.instagram.com/nailnowbr/"
              target="_blank"
              rel="noopener noreferrer"
              aria-label="Instagram da NailNow"
            >
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M7 3C4.24 3 2 5.24 2 8v8c0 2.76 2.24 5 5 5h10c2.76 0 5-2.24 5-5V8c0-2.76-2.24-5-5-5H7zm10 2a3 3 0 0 1 3 3v8a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V8a3 3 0 0 1 3-3h10zm-5 3.5A4.5 4.5 0 1 0 16.5 13 4.5 4.5 0 0 0 12 8.5zm0 2A2.5 2.5 0 1 1 9.5 13 2.5 2.5 0 0 1 12 10.5zm4.75-4.75a1 1 0 1 0 1 1 1 1 0 0 0-1-1z"
                />
              </svg>
            </a>
          </div>
        </div>
      </div>
    </header>

    <main class="page-content">
      <div id="login-view" class="auth-layout" aria-labelledby="auth-heading">
        <section class="auth-hero">
        <p class="auth-kicker">Painel para manicures NailNow</p>
        <h1 id="auth-heading">Faça login para cuidar da sua agenda</h1>
        <p class="auth-intro">
          Acesse seu espaço exclusivo para confirmar atendimentos, organizar horários e acompanhar pagamentos com segurança.
        </p>
        <ul class="auth-benefits">
          <li>Sincronize sua agenda em tempo real com os pedidos das clientes.</li>
          <li>Confirme reservas com um toque e receba notificações instantâneas.</li>
          <li>Controle seus ganhos e acompanhe o histórico de atendimentos.</li>
        </ul>
        </section>

        <section class="auth-card" aria-labelledby="login-heading">
          <div class="auth-card__inner">
            <h2 id="login-heading">Entrar com e-mail e senha</h2>
            <p class="auth-card__hint">Use o e-mail cadastrado na NailNow para acessar o painel de manicures.</p>
            <form id="login-form" class="auth-form" novalidate>
              <div class="auth-form__group">
                <label for="email">E-mail</label>
                <input type="email" id="email" name="email" autocomplete="email" required placeholder="seunome@nailnow.com" />
              </div>
              <div class="auth-form__group">
                <label for="password">Senha</label>
                <input type="password" id="password" name="password" autocomplete="current-password" required placeholder="••••••••" />
              </div>
              <button type="submit" class="auth-form__submit">Entrar</button>
            </form>
            <div id="login-status" class="auth-status" role="alert" aria-live="polite" hidden></div>
            <div class="auth-actions">
              <button type="button" id="reset-password" class="auth-link-button">Esqueci minha senha</button>
              <a href="./cadastro.html" class="auth-secondary-link">Ainda não é parceira? Cadastre-se</a>
            </div>
          </div>
        </section>
      </div>

      <div id="dashboard" class="dashboard" hidden aria-labelledby="dashboard-heading">
        <section class="dashboard-hero">
          <div class="dashboard-hero__header">
            <div>
              <p class="dashboard-kicker">Painel NailNow</p>
              <h1 id="dashboard-heading">Olá, <span data-profile-name>manicure</span>!</h1>
              <p class="dashboard-intro">Gerencie sua agenda, acompanhe solicitações e mantenha o relacionamento com suas clientes em um só lugar.</p>
            </div>
            <button type="button" id="sign-out" class="dashboard-signout">Sair</button>
          </div>
          <div class="dashboard-summary">
            <article class="profile-card" aria-labelledby="profile-heading">
              <h2 id="profile-heading">Meu perfil</h2>
              <dl class="profile-details">
                <div class="profile-details__item">
                  <dt>Nome</dt>
                  <dd id="profile-display">—</dd>
                </div>
                <div class="profile-details__item">
                  <dt>E-mail</dt>
                  <dd id="profile-email">—</dd>
                </div>
                <div class="profile-details__item">
                  <dt>Especialidades</dt>
                  <dd id="profile-specialties">Alongamento em fibra · Spa das mãos</dd>
                </div>
                <div class="profile-details__item">
                  <dt>Área de atendimento</dt>
                  <dd id="profile-area">São Paulo e região metropolitana</dd>
                </div>
              </dl>
            </article>
            <div class="dashboard-metrics" aria-label="Resumo da agenda">
              <div class="metric-card">
                <span class="metric-label">Solicitações</span>
                <span class="metric-value" id="metric-pending">0</span>
                <span class="metric-footnote">aguardando resposta</span>
              </div>
              <div class="metric-card">
                <span class="metric-label">Confirmados</span>
                <span class="metric-value" id="metric-confirmed">0</span>
                <span class="metric-footnote">para os próximos dias</span>
              </div>
              <div class="metric-card">
                <span class="metric-label">Últimos 30 dias</span>
                <span class="metric-value" id="metric-past">0</span>
                <span class="metric-footnote">atendimentos concluídos</span>
              </div>
            </div>
          </div>
        </section>

        <section class="schedule-section" aria-labelledby="pending-heading">
          <div class="schedule-section__head">
            <h2 id="pending-heading">Solicitações de agendamento</h2>
            <span class="schedule-count" id="badge-pending">0</span>
          </div>
          <div id="pending-list" class="schedule-list" role="list"></div>
        </section>

        <section class="schedule-section" aria-labelledby="confirmed-heading">
          <div class="schedule-section__head">
            <h2 id="confirmed-heading">Agendamentos confirmados</h2>
            <span class="schedule-count" id="badge-confirmed">0</span>
          </div>
          <div id="confirmed-list" class="schedule-list" role="list"></div>
        </section>

        <section class="schedule-section" aria-labelledby="past-heading">
          <div class="schedule-section__head">
            <h2 id="past-heading">Atendimentos realizados</h2>
            <span class="schedule-count" id="badge-past">0</span>
          </div>
          <div id="past-list" class="schedule-list" role="list"></div>
        </section>
      </div>
    </main>

    <main class="auth-layout" aria-labelledby="auth-heading">
      <section class="auth-hero">
        <p class="auth-kicker">Painel para manicures NailNow</p>
        <h1 id="auth-heading">Faça login para cuidar da sua agenda</h1>
        <p class="auth-intro">
          Acesse seu espaço exclusivo para confirmar atendimentos, organizar horários e acompanhar pagamentos com segurança.
        </p>
        <ul class="auth-benefits">
          <li>Sincronize sua agenda em tempo real com os pedidos das clientes.</li>
          <li>Confirme reservas com um toque e receba notificações instantâneas.</li>
          <li>Controle seus ganhos e acompanhe o histórico de atendimentos.</li>
        </ul>
      </section>

      <section class="auth-card" aria-labelledby="login-heading">
        <div class="auth-card__inner">
          <h2 id="login-heading">Entrar com e-mail e senha</h2>
          <p class="auth-card__hint">Use o e-mail cadastrado na NailNow para acessar o painel de manicures.</p>
          <form id="login-form" class="auth-form" novalidate>
            <div class="auth-form__group">
              <label for="email">E-mail</label>
              <input type="email" id="email" name="email" autocomplete="email" required placeholder="seunome@nailnow.com" />
            </div>
            <div class="auth-form__group">
              <label for="password">Senha</label>
              <input type="password" id="password" name="password" autocomplete="current-password" required placeholder="••••••••" />
            </div>
            <button type="submit" class="auth-form__submit">Entrar</button>
          </form>
          <div id="login-status" class="auth-status" role="alert" aria-live="polite"></div>
          <div class="auth-actions">
            <button type="button" id="reset-password" class="auth-link-button">Esqueci minha senha</button>
            <a href="./cadastro.html" class="auth-secondary-link">Ainda não é parceira? Cadastre-se</a>
          </div>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      <div class="footer-inner">
        <div class="footer-column footer-column--brand">
          <h2 class="footer-logo">NailNow</h2>
          <p>Beleza na sua agenda com profissionais selecionadas, atendimento onde você estiver e suporte humanizado.</p>
        </div>
        <div class="footer-column footer-links" aria-label="Links úteis">
          <h3>FAQ</h3>
          <a href="../faq.html">Perguntas frequentes</a>
          <a href="../como-funciona.html">Como funciona</a>
          <a href="../agendamentos.html">Agendamentos</a>
        </div>
        <div class="footer-column footer-links" aria-label="Contato e suporte">
          <h3>Contato & suporte</h3>
          <a href="mailto:contato@nailnow.com">contato@nailnow.com</a>
        </div>
        <div class="footer-column footer-links" aria-label="Termos e políticas">
          <h3>Termos & políticas</h3>
          <a href="#">Termos de uso</a>
          <a href="#">Política de privacidade</a>
          <a href="#">Cookies e preferências</a>
        </div>
      </div>
      <p class="footer-copy">© NailNow 2025. Todos os direitos reservados.</p>
    </footer>
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
      import {
        getAuth,
        onAuthStateChanged,
        sendPasswordResetEmail,
        signInWithEmailAndPassword,
        signOut,
      } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

      const firebaseConfig = {
        apiKey: "AIzaSyDvMxPKyw7M70fvj-YLwzudfIaquohkDIA",
        authDomain: "nailnow-site.firebaseapp.com",
        projectId: "nailnow-site",
        storageBucket: "nailnow-site.appspot.com",
        messagingSenderId: "145591976960",
        appId: "1:145591976960:web:957f13cd9d61acdfda4dde",
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);

      const loginForm = document.getElementById("login-form");
      const statusEl = document.getElementById("login-status");
      const submitButton = loginForm.querySelector("button[type='submit']");
      const resetButton = document.getElementById("reset-password");
      const loginView = document.getElementById("login-view");
      const dashboard = document.getElementById("dashboard");
      const signOutButton = document.getElementById("sign-out");
      const profileNameElements = document.querySelectorAll("[data-profile-name]");
      const profileDisplay = document.getElementById("profile-display");
      const profileEmail = document.getElementById("profile-email");
      const metricPending = document.getElementById("metric-pending");
      const metricConfirmed = document.getElementById("metric-confirmed");
      const metricPast = document.getElementById("metric-past");
      const badgePending = document.getElementById("badge-pending");
      const badgeConfirmed = document.getElementById("badge-confirmed");
      const badgePast = document.getElementById("badge-past");
      const pendingList = document.getElementById("pending-list");
      const confirmedList = document.getElementById("confirmed-list");
      const pastList = document.getElementById("past-list");

      const appointmentData = {
        pending: [
          {
            id: "SOL-1842",
            client: "Bianca Lopes",
            service: "Alongamento em fibra de vidro",
            date: "2025-05-08",
            time: "14:00",
            location: "Pinheiros, São Paulo",
            price: "R$ 180,00",
            note: "Prefere acabamento natural e formato amendoado.",
          },
          {
            id: "SOL-1853",
            client: "Thais Camargo",
            service: "Spa das mãos + esmaltação gel",
            date: "2025-05-09",
            time: "09:30",
            location: "Brooklin, São Paulo",
            price: "R$ 140,00",
            note: "Levar paleta de tons nudes.",
          },
        ],
        confirmed: [
          {
            id: "AGEN-1027",
            client: "Larissa Monteiro",
            service: "Blindagem + esmaltação",
            date: "2025-05-06",
            time: "18:30",
            location: "Vila Mariana, São Paulo",
            price: "R$ 165,00",
            note: "Cliente indicou preferência por glitter rosé.",
          },
          {
            id: "AGEN-1028",
            client: "Amanda Reis",
            service: "Pedicure + spa relaxante",
            date: "2025-05-07",
            time: "10:00",
            location: "Moema, São Paulo",
            price: "R$ 120,00",
            note: "Chegar 10 min antes para montagem do espaço.",
          },
        ],
        past: [
          {
            id: "HIST-980",
            client: "Nathalia Cruz",
            service: "Esmaltação em gel",
            date: "2025-04-29",
            time: "16:30",
            location: "Itaim Bibi, São Paulo",
            price: "R$ 110,00",
            note: "Avaliação 5 estrelas enviada.",
          },
          {
            id: "HIST-975",
            client: "Juliana Prado",
            service: "Alongamento em fibra",
            date: "2025-04-25",
            time: "11:00",
            location: "Tatuapé, São Paulo",
            price: "R$ 190,00",
            note: "Cliente agendou manutenção para daqui 3 semanas.",
          },
        ],
      };

      const setStatus = (message, type = "") => {
        statusEl.textContent = message;
        statusEl.classList.remove("auth-status--error", "auth-status--success");
        statusEl.hidden = !message;
        if (type) {
          statusEl.classList.add(`auth-status--${type}`);
        }
      };

      const setLoading = (isLoading) => {
        submitButton.disabled = isLoading;
        submitButton.textContent = isLoading ? "Entrando..." : "Entrar";
      };

      loginForm.addEventListener("submit", async (event) => {
        event.preventDefault();
        const email = loginForm.email.value.trim();
        const password = loginForm.password.value;

        if (!email || !password) {
          setStatus("Preencha e-mail e senha para continuar.", "error");
          return;
        }

        setStatus("");
        setLoading(true);

        try {
          await signInWithEmailAndPassword(auth, email, password);
          setStatus("Login realizado com sucesso! Redirecionando para o painel...", "success");
          loginForm.reset();
        } catch (error) {
          console.error("Erro no login", error);
          let friendlyMessage = "Não foi possível entrar. Verifique seus dados.";
          if (error.code === "auth/invalid-email") {
            friendlyMessage = "Formato de e-mail inválido.";
          } else if (error.code === "auth/user-not-found" || error.code === "auth/wrong-password") {
            friendlyMessage = "Credenciais não encontradas. Confira e tente novamente.";
          } else if (error.code === "auth/too-many-requests") {
            friendlyMessage = "Muitas tentativas. Aguarde alguns minutos e tente novamente.";
          }
          setStatus(friendlyMessage, "error");
        } finally {
          setLoading(false);
        }
      });

      resetButton.addEventListener("click", async () => {
        const email = loginForm.email.value.trim();
        if (!email) {
          setStatus("Informe seu e-mail para enviarmos o link de redefinição.", "error");
          return;
        }

        setStatus("Enviando instruções de redefinição...", "");
        resetButton.disabled = true;

        try {
          await sendPasswordResetEmail(auth, email);
          setStatus("Enviamos um link de redefinição para o seu e-mail.", "success");
        } catch (error) {
          console.error("Erro ao enviar redefinição", error);
          let friendlyMessage = "Não foi possível enviar o e-mail de redefinição.";
          if (error.code === "auth/invalid-email") {
            friendlyMessage = "Formato de e-mail inválido.";
          } else if (error.code === "auth/user-not-found") {
            friendlyMessage = "Não encontramos uma manicure com esse e-mail.";
          }
          setStatus(friendlyMessage, "error");
        } finally {
          resetButton.disabled = false;
        }
      });

      const toggleView = (isLoggedIn) => {
        loginView.hidden = isLoggedIn;
        dashboard.hidden = !isLoggedIn;
      };

      const dateFormatter = new Intl.DateTimeFormat("pt-BR", {
        day: "2-digit",
        month: "short",
        weekday: "short",
      });

      const timeFormatter = new Intl.DateTimeFormat("pt-BR", {
        hour: "2-digit",
        minute: "2-digit",
      });

      const createAppointmentCard = (appointment, status) => {
        const wrapper = document.createElement("article");
        wrapper.className = `schedule-card schedule-card--${status}`;
        wrapper.setAttribute("role", "listitem");

        const appointmentDate = new Date(`${appointment.date}T${appointment.time}`);

        wrapper.innerHTML = `
          <header class="schedule-card__header">
            <span class="schedule-card__id">${appointment.id}</span>
            <span class="schedule-card__status">${
              status === "pending"
                ? "Aguardando confirmação"
                : status === "confirmed"
                ? "Confirmado"
                : "Atendimento concluído"
            }</span>
          </header>
          <div class="schedule-card__body">
            <div class="schedule-card__info">
              <h3>${appointment.client}</h3>
              <p class="schedule-card__service">${appointment.service}</p>
              <p class="schedule-card__note">${appointment.note}</p>
            </div>
            <dl class="schedule-card__meta">
              <div>
                <dt>Data</dt>
                <dd>${dateFormatter.format(appointmentDate)}</dd>
              </div>
              <div>
                <dt>Horário</dt>
                <dd>${timeFormatter.format(appointmentDate)}</dd>
              </div>
              <div>
                <dt>Local</dt>
                <dd>${appointment.location}</dd>
              </div>
              <div>
                <dt>Valor</dt>
                <dd>${appointment.price}</dd>
              </div>
            </dl>
          </div>
        `;

        return wrapper;
      };

      const renderAppointments = (type, items) => {
        const listMap = {
          pending: pendingList,
          confirmed: confirmedList,
          past: pastList,
        };

        const listElement = listMap[type];
        listElement.innerHTML = "";

        if (!items.length) {
          const emptyState = document.createElement("p");
          emptyState.className = "schedule-empty";
          emptyState.textContent =
            type === "pending"
              ? "Nenhuma solicitação aguardando confirmação."
              : type === "confirmed"
              ? "Você não possui agendamentos confirmados no momento."
              : "Sem atendimentos recentes registrados.";
          listElement.appendChild(emptyState);
          return;
        }

        items.forEach((appointment) => {
          listElement.appendChild(createAppointmentCard(appointment, type));
        });
      };

      const updateMetrics = () => {
        const pendingCount = appointmentData.pending.length;
        const confirmedCount = appointmentData.confirmed.length;
        const pastCount = appointmentData.past.length;

        metricPending.textContent = pendingCount;
        metricConfirmed.textContent = confirmedCount;
        metricPast.textContent = pastCount;

        badgePending.textContent = pendingCount;
        badgeConfirmed.textContent = confirmedCount;
        badgePast.textContent = pastCount;
      };

      const populateDashboard = (user) => {
        const fallbackName = user.email.split("@")[0].replace(/[._-]+/g, " ");
        const displayName = (user.displayName || fallbackName)
          .split(" ")
          .filter(Boolean)
          .map((part) => part.charAt(0).toUpperCase() + part.slice(1))
          .join(" ");

        profileNameElements.forEach((element) => {
          element.textContent = displayName;
        });

        profileDisplay.textContent = displayName;
        profileEmail.textContent = user.email;

        updateMetrics();
        renderAppointments("pending", appointmentData.pending);
        renderAppointments("confirmed", appointmentData.confirmed);
        renderAppointments("past", appointmentData.past);
      };

      onAuthStateChanged(auth, (user) => {
        if (user) {
          populateDashboard(user);
          toggleView(true);
        } else {
          toggleView(false);
        }
      });

      signOutButton.addEventListener("click", async () => {
        signOutButton.disabled = true;
        signOutButton.textContent = "Saindo...";

        try {
          await signOut(auth);
          setStatus("Você saiu do portal. Faça login novamente para acessar.");
        } catch (error) {
          console.error("Erro ao sair", error);
          setStatus("Não foi possível encerrar a sessão. Tente novamente.", "error");
        } finally {
          signOutButton.disabled = false;
          signOutButton.textContent = "Sair";
        }
      });
    </script>
  </body>
</html>
